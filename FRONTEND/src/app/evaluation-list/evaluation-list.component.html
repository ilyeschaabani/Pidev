<div class="container mt-5">
    <div class="row">
      <div class="col-md-12">
        <div class="card shadow-sm">
          <div class="card-header bg-primary text-white">
            <h3 class="mb-0">
              <i class="fas fa-tasks me-2"></i>Assign Questions to Quiz
            </h3>
          </div>
  <!-- Dans votre template (ex: home.component.html) -->
<button (click)="navigateToQuizapi()" class="btn btn-primary">
  QUIZApi
</button>
          <div class="card-body">
            <!-- Quiz List -->
            <div class="list-group">
              <div *ngFor="let eval of evaluations" class="list-group-item mb-3">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <h5>{{ eval.titre }}</h5>
                    <small class="text-muted">{{ eval.description }}</small>
                  </div>
                  <span class="badge" [ngClass]="{
                    'bg-warning': !questionsMap[eval.idEvaluation]?.length,
                    'bg-success': questionsMap[eval.idEvaluation]?.length
                  }">
                    {{ getEvaluationStatus(eval.idEvaluation) }}
                  </span>
                </div>
  
                <!-- Questions Section -->
                <div *ngIf="expandedEvaluation === eval.idEvaluation" class="mt-3">
                  <div *ngIf="loadingStates[eval.idEvaluation]" class="text-center py-2">
                    <div class="spinner-border spinner-border-sm"></div>
                    <span>Loading questions...</span>
                  </div>
  
                  <div *ngIf="!loadingStates[eval.idEvaluation]">
                    <div *ngIf="!questionsMap[eval.idEvaluation]?.length" class="alert alert-warning">
                      No questions assigned yet
                    </div>
  
                    <div *ngIf="questionsMap[eval.idEvaluation]?.length" class="mt-2">
                      <h6>Assigned Questions:</h6>
                      <ul class="list-group">
                        <li *ngFor="let question of questionsMap[eval.idEvaluation]" 
                            class="list-group-item">
                          {{ question.texte || question.contenu || 'No question text' }}
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
  
                <!-- Action Buttons -->
                <div class="d-flex gap-2 mt-2">
                  <button class="btn btn-sm btn-outline-primary"
                          (click)="toggleEvaluationDetails(eval.idEvaluation)">
                    {{ expandedEvaluation === eval.idEvaluation ? 'Hide' : 'Show' }} Details
                  </button>
                  <button class="btn btn-sm btn-success"
                          (click)="startEvaluation(eval.idEvaluation)"
                          [disabled]="!questionsMap[eval.idEvaluation]?.length">
                    Start Quiz
                  </button>
                  <button class="btn btn-info btn-sm"
          (click)="assignQuestions(eval)"
          title="Assign questions to this quiz">
    <i class="fas fa-tasks me-1"></i> Assign Questions
  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>