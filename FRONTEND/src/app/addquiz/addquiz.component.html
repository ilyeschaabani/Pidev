<div class="layout-wrapper layout-content-navbar">
  <div class="layout-container">
    <!-- Sidebar -->
    <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
      <app-dashbordadmin></app-dashbordadmin> <!-- This is your Dashboard Admin component -->
    </aside>

    <!-- Main Content -->
    <div class="layout-page">
      <!-- Content Wrapper -->
      <div class="content-wrapper" style="position: relative;">
        <!-- Quiz Creation Section -->
        <div class="container-fluid">
          <div class="card">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
              <!-- Updated Heading -->
              <h4 class="mb-0 text-white">Créer un nouveau Quiz</h4>
              <button class="btn btn-sm btn-light" (click)="navigateToQuizList()">
                <i class="fas fa-list me-1"></i> Liste des Quiz
              </button>
              <button class="btn btn-sm btn-light" (click)="navigateToQuestions()">
                <i class="fas fa-list me-1"></i> Ajouter des Questions
              </button>
            </div>
            
            <div class="card-body">
              <form (ngSubmit)="onSubmit()" [formGroup]="quizForm">
                <!-- Title Field -->
                <div class="mb-3">
                  <label class="form-label">Titre <span class="text-danger">*</span></label>
                  <input formControlName="titre" class="form-control" 
                         [class.is-invalid]="f['titre'].invalid && (f['titre'].touched || f['titre'].dirty)">
                  <div *ngIf="f['titre'].invalid && (f['titre'].touched || f['titre'].dirty)" class="invalid-feedback">
                    <div *ngIf="f['titre'].errors?.['required']">Le titre est requis</div>
                    <div *ngIf="f['titre'].errors?.['minlength']">Minimum 3 caractères</div>
                  </div>
                </div>

                <!-- Description Field -->
                <div class="mb-3">
                  <label class="form-label">Description</label>
                  <textarea formControlName="description" class="form-control" rows="3"></textarea>
                </div>

                <!-- Form Fields for Max Marks, Number of Questions, and Duration -->
                <div class="row mb-3">
                  <div class="col-md-4">
                    <label class="form-label">Note maximale <span class="text-danger">*</span></label>
                    <input formControlName="maxMarks" type="number" class="form-control"
                           [class.is-invalid]="f['maxMarks'].invalid && (f['maxMarks'].touched || f['maxMarks'].dirty)">
                    <div *ngIf="f['maxMarks'].invalid && (f['maxMarks'].touched || f['maxMarks'].dirty)" class="invalid-feedback">
                      <div *ngIf="f['maxMarks'].errors?.['required']">Ce champ est requis</div>
                      <div *ngIf="f['maxMarks'].errors?.['min']">Doit être supérieur à 0</div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <label class="form-label">Nombre de questions <span class="text-danger">*</span></label>
                    <input formControlName="noOfQuestions" type="number" class="form-control"
                           [class.is-invalid]="f['noOfQuestions'].invalid && (f['noOfQuestions'].touched || f['noOfQuestions'].dirty)">
                    <div *ngIf="f['noOfQuestions'].invalid && (f['noOfQuestions'].touched || f['noOfQuestions'].dirty)" class="invalid-feedback">
                      <div *ngIf="f['noOfQuestions'].errors?.['required']">Ce champ est requis</div>
                      <div *ngIf="f['noOfQuestions'].errors?.['min']">Doit être supérieur à 0</div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <label class="form-label">Durée (minutes) <span class="text-danger">*</span></label>
                    <input formControlName="duree" type="number" class="form-control"
                           [class.is-invalid]="f['duree'].invalid && (f['duree'].touched || f['duree'].dirty)">
                    <div *ngIf="f['duree'].invalid && (f['duree'].touched || f['duree'].dirty)" class="invalid-feedback">
                      <div *ngIf="f['duree'].errors?.['required']">Ce champ est requis</div>
                      <div *ngIf="f['duree'].errors?.['min']">Doit être supérieur à 0</div>
                    </div>
                  </div>
                </div>

                <!-- Active Switch -->
                <div class="mb-3 form-check form-switch">
                  <input type="checkbox" formControlName="active" class="form-check-input" id="activeSwitch">
                  <label class="form-check-label" for="activeSwitch">Quiz actif</label>
                </div>

                <!-- Action Buttons -->
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                  <button type="button" class="btn btn-secondary me-md-2" (click)="navigateToQuizList()">
                    <i class="fas fa-arrow-left me-1"></i> Retour à la liste
                  </button>
                  <button type="submit" class="btn btn-primary" [disabled]="isLoading || quizForm.invalid">
                    <span *ngIf="!isLoading">
                      <i class="fas fa-save me-1"></i> Créer le Quiz
                    </span>
                    <span *ngIf="isLoading">
                      <span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>
                      Création...
                    </span>
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
